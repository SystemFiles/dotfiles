# RC Configuration
# Author: Ben Sykes (Statcan)

# ~/.zshrc
# shellcheck shell=bash
# shellcheck source=/dev/null
# shellcheck disable=SC2034

{{- if eq .chezmoi.os "darwin" -}}
# Brew Configuration
# ---------------------------------------------------------------------------------
export HOMEBREW_NO_AUTO_UPDATE=1
{{- end -}}

# ZSH Configuration
# ---------------------------------------------------------------------------------

export PATH=$HOME/bin:$PATH
[ -d /snap/bin ] && export PATH=/snap/bin:$PATH
[ -d $HOME/.cargo/bin ] && export PATH=$HOME/.cargo/bin:$PATH
[ -d $HOME/.local/bin ] && export PATH=$HOME/.local/bin:$PATH
[ -d $HOME/gittools ] && export PATH=$HOME/gittools:$PATH

[ -f $HOME/.oh-my-zsh ] && export ZSH=$HOME/.oh-my-zsh

plugins=(
  colored-man-pages
  common-aliases
  docker
  docker-compose
  dotenv
  git
  gpg-agent
  history
  kubectl
  terraform
  vi-mode
)

# Oh-My-ZSH Theme
ZSH_THEME="021011"

DISABLE_AUTO_UPDATE="true"
ZSH_DISABLE_COMPFIX=true

source $ZSH/oh-my-zsh.sh

# Includes
# ---------------------------------------------------------------------------------

[ -f $HOME/.bash_aliases ] && source $HOME/.bash_aliases
[ -f $HOME/.bash_exports ] && source $HOME/.bash_exports
[ -f $HOME/.bash_functions ] && source $HOME/.bash_functions

{{- if .kubernetes -}}
# Kubernetes Config
# ---------------------------------------------------------------------------------

# Get Kubectl Command Completions
source <(kubectl completion zsh)

[[ -f ~/.kube_aliases ]] && source $HOME/.kube_aliases

{{- if .work -}}
alias kl='kubelogin convert-kubeconfig'
{{- end -}}
{{- end -}}

# History Configuration
# ---------------------------------------------------------------------------------

export HISTTIMEFORMAT=' %Y_%m%d_%T'
export HISTSIZE=99999
export HISTFILESIZE=99999
export LESS='-j15 R'

alias h=history
alias k=kubectl

{{- if (and (.kubernetes) (eq .chezmoi.hostname "l-sykeben-1.statcan.ca")) -}}
# Kubernetes Cloud Workstation Config
export KUBECONFIG="${KUBECONFIG}:$HOME/.kube/k8s-cancentral-01-dev-shared/kubeconfig.canadacentral.json:{{ .chezmoi.homeDir }}/.kube/k8s-cancentral-01-infratest-shared/kubeconfig.canadacentral.json:{{ .chezmoi.homeDir }}/.kube/k8s-cancentral-01-management-shared/kubeconfig.canadacentral.json:{{ .chezmoi.homeDir }}/.kube/k8s-cancentral-01-production-shared/kubeconfig.canadacentral.json:{{ .chezmoi.homeDir }}/.kube/k8s-cancentral-01-test-shared/kubeconfig.canadacentral.json:{{ .chezmoi.homeDir }}/.kube/k8s-cancentral-02-innovation-shared/kubeconfig.canadacentral.json"
{{- end -}}


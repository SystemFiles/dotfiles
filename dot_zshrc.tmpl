# ~/.zshrc
# shellcheck shell=bash
# shellcheck source=/dev/null
# shellcheck disable=SC2034

{{ if eq .chezmoi.os "darwin" }}

# Brew Configuration
# ---------------------------------------------------------------------------------
export HOMEBREW_NO_AUTO_UPDATE=1

{{ end }}

# ZSH Configuration
# ---------------------------------------------------------------------------------

export PATH={{ .chezmoi.homeDir }}/bin:$PATH
[ -d /snap/bin ] && export PATH=/snap/bin:$PATH
[ -d {{ .chezmoi.homeDir }}/.cargo/bin ] && export PATH={{ .chezmoi.homeDir }}/.cargo/bin:$PATH
[ -d {{ .chezmoi.homeDir }}/go/bin ] && export PATH={{ .chezmoi.homeDir }}/go/bin:$PATH
[ -d {{ .chezmoi.homeDir }}/.local/bin ] && export PATH={{ .chezmoi.homeDir }}/.local/bin:$PATH
[ -d {{ .chezmoi.homeDir }}/.gittools ] && export PATH={{ .chezmoi.homeDir }}/.gittools:$PATH

export ZSH={{ .chezmoi.homeDir }}/.oh-my-zsh

plugins=(
  colored-man-pages
  docker
  docker-compose
  dotenv
  gpg-agent
  history
  kubectl
  terraform
  vi-mode
  rust
  golang
  z
)

# Oh-My-ZSH Theme
ZSH_THEME="021011/021011"

DISABLE_AUTO_UPDATE="true"
ZSH_DISABLE_COMPFIX=true

source $ZSH/oh-my-zsh.sh

# Includes
# ---------------------------------------------------------------------------------

[ -f {{ .chezmoi.homeDir }}/.bash_aliases ] && source {{ .chezmoi.homeDir }}/.bash_aliases
[ -f {{ .chezmoi.homeDir }}/.bash_exports ] && source {{ .chezmoi.homeDir }}/.bash_exports
[ -f {{ .chezmoi.homeDir }}/.bash_functions ] && source {{ .chezmoi.homeDir }}/.bash_functions
[ -f {{ .chezmoi.homeDir }}/.zsh_custom ] && source {{ .chezmoi.homeDir }}/.zsh_custom

{{ if .kubernetes }}
# Kubernetes Config
# ---------------------------------------------------------------------------------

# Get Kubectl Command Completions
source <(kubectl completion zsh)

[[ -f ~/.kube_aliases ]] && source {{ .chezmoi.homeDir }}/.kube_aliases

{{ if .work }}
alias kl='kubelogin convert-kubeconfig'

if [[ -z $KUBECONFIG ]]; then
  export KUBECONFIG={{ .chezmoi.homeDir }}/.kube/config
fi
export KUBECONFIGS="${KUBECONFIG}:{{ .chezmoi.homeDir }}/.kube/k8s-cancentral-01-dev-shared/kubeconfig.canadacentral.json:{{ .chezmoi.homeDir }}/.kube/k8s-cancentral-01-infratest-shared/kubeconfig.canadacentral.json:{{ .chezmoi.homeDir }}/.kube/k8s-cancentral-01-management-shared/kubeconfig.canadacentral.json:{{ .chezmoi.homeDir }}/.kube/k8s-cancentral-01-production-shared/kubeconfig.canadacentral.json:{{ .chezmoi.homeDir }}/.kube/k8s-cancentral-01-test-shared/kubeconfig.canadacentral.json:{{ .chezmoi.homeDir }}/.kube/k8s-cancentral-02-innovation-shared/kubeconfig.canadacentral.json"
{{ end }}

{{ end }}

# History Configuration
# ---------------------------------------------------------------------------------

export HISTSIZE=99999
export HISTFILESIZE=99999
export LESS='-j5 R'
alias h='history -i'

{{ if (and (.kubernetes) (.work)) }}
# Kubernetes Cloud Workstation Config
export KUBECONFIG="${KUBECONFIG}:{{ .chezmoi.homeDir }}/.kube/k8s-cancentral-01-dev-shared/kubeconfig.canadacentral.json:{{ .chezmoi.homeDir }}/.kube/k8s-cancentral-01-infratest-shared/kubeconfig.canadacentral.json:{{ .chezmoi.homeDir }}/.kube/k8s-cancentral-01-management-shared/kubeconfig.canadacentral.json:{{ .chezmoi.homeDir }}/.kube/k8s-cancentral-01-production-shared/kubeconfig.canadacentral.json:{{ .chezmoi.homeDir }}/.kube/k8s-cancentral-01-test-shared/kubeconfig.canadacentral.json:{{ .chezmoi.homeDir }}/.kube/k8s-cancentral-02-innovation-shared/kubeconfig.canadacentral.json"
{{ end }}

